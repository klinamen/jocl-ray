package io.klinamen.joclray.samples;

import io.klinamen.joclray.geom.Plane;
import io.klinamen.joclray.geom.Sphere;
import io.klinamen.joclray.geom.TriangleMesh;
import io.klinamen.joclray.light.PointLight;
import io.klinamen.joclray.light.SpotLight;
import io.klinamen.joclray.scene.Camera;
import io.klinamen.joclray.scene.Scene;
import io.klinamen.joclray.transformations.ejml.*;
import io.klinamen.joclray.util.FloatVec4;
import io.klinamen.joclray.util.IoR;

public class Scene4 {
    public static Scene build() {
        return new Scene(new Camera()
                .setFovGrad(60)
        )
                .setAmbientLightIntensity(0.2f)
                .add(new PointLight()
                        .setIntensity(1f)
                        .setPosition(new FloatVec4(6, 8, 0))
                )
//                .add(new PointLight()
//                        .setIntensity(0.5f)
//                        .setPosition(new FloatVec4(0, 8, 0))
//                )
                .add(new SpotLight()
                        .setIntensity(2.5f)
                        .setPosition(new FloatVec4(-10, 8, -5))
                        .setAngleGrad(50)
                        .setFallout(0.8f)
                        .setDirection(new FloatVec4(0.2f, -0.5f, -1))
                )
                .add(new SpotLight()
                        .setIntensity(2.5f)
                        .setPosition(new FloatVec4(-10, 8, -5))
                        .setAngleGrad(50)
                        .setFallout(0.8f)
                        .setDirection(new FloatVec4(2f, -1f, -1))
                )
                .add("Ceiling", new Plane()
                        .setNormal(new FloatVec4(0, -1, 0))
                        .setPosition(new FloatVec4(0, 20, 0))
                        .setKd(new FloatVec4(0.752f, 0.901f, 0.925f))
                )
                .add("Floor", new Plane()
                        .setNormal(new FloatVec4(0, 1, 0))
                        .setPosition(new FloatVec4(0, -5, 0))
                        .setKd(new FloatVec4(0.3f, 0.2f, 0.3f))
                        .setKs(new FloatVec4(0.3f, 0.3f, 0.3f))
                        .setKr(new FloatVec4(0.2f, 0.2f, 0.2f))
                        .setPhongExp(10)
                )
                .add("Back_Wall", new Plane()
                                .setNormal(new FloatVec4(0, 0, 1))
                                .setPosition(new FloatVec4(0, 0, -50))
                                .setKd(new FloatVec4(0.3f, 0.1f, 0.1f))
//                        .setKr(new FloatVec4(0.3f, 0.1f, 0.1f))
                                .setPhongExp(1000)
                )
                .add("Left_Wall", new Plane()
                        .setNormal(new FloatVec4(1, 0, 0))
                        .setPosition(new FloatVec4(-20, 0, 0))
                        .setKd(new FloatVec4(0.1f, 0.1f, 0.3f))
                        .setKr(new FloatVec4(0.1f, 0.1f, 0.3f))
                        .setPhongExp(1000)
                )
                .add("Right_Wall", new Plane()
                        .setNormal(new FloatVec4(-1, 0, 0))
                        .setPosition(new FloatVec4(20, 0, 0))
                        .setKd(new FloatVec4(0.1f, 0.3f, 0.1f))
                        .setKr(new FloatVec4(0.1f, 0.3f, 0.1f))
                        .setPhongExp(1000)
                )
                .add("Front_Wall", new Plane()
                        .setNormal(new FloatVec4(0, 0, 1))
                        .setPosition(new FloatVec4(0, 0, 10))
                        .setKd(new FloatVec4(0.3f, 0.1f, 0.1f))
                        .setPhongExp(1000)
                )
//                .add("Teapot", Meshes.teapot()
//                        .transform(new CompositeTransformation()
//                                .add(RotateXTransformation.withGradAngle(-90))
//                                .add(RotateYTransformation.withGradAngle(180))
//                                .add(RotateYTransformation.withGradAngle(60))
//                                .add(new ScaleTransformation(0.8, 0.8, 0.8))
//                                .add(new TranslateTransformation(-4, -5, -32))
//                        )
//                        .setKd(new FloatVec4(0.27f, 0.27f, 0.25f))
//                        .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
////                        .setKr(new FloatVec4(0.1f, 0.1f, 0.1f))
//                        .setPhongExp(1000)
//                )
//                .add("Blue Sphere", new Sphere()
//                        .setCenter(new FloatVec4(4, 2, -25))
//                        .setRadius(3)
//                        .setIor(1.2f)
//                        .setKd(new FloatVec4(0, 0f, 0.5f))
//                        .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
//                        .setKr(new FloatVec4(0.4f, 0.4f, 0.2f))
//                        .setPhongExp(800)
//                )
                .add("Teapot_Glass_Blue", teapot()
                        .transform(new TranslateTransformation(10, -2, -15))
                        .setIor(IoR.WATER)
                        .setKd(new FloatVec4(0.0f, 0f, 0.05f))
                        .setKr(new FloatVec4(0.1f, 0.1f, 0.15f))
                )
                .add("Sphere_Red", new Sphere()
                        .setCenter(new FloatVec4(3, -3.5f, -10))
                        .setRadius(1.5f)
                        .setKd(new FloatVec4(0.5f, 0.1f, 0.0f))
                        .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
                        .setKr(new FloatVec4(0.2f, 0.2f, 0.2f))
                        .setPhongExp(1500)
                )
                .add("Teapot_Red", teapot()
                        .transform(new TranslateTransformation(5, -2, -20))
                        .setIor(0)
                        .setKd(new FloatVec4(0.5f, 0.1f, 0f))
                        .setKr(new FloatVec4(0.2f, 0.1f, 0.1f))
                )
                .add("Sphere_Glass", new Sphere()
                                .setCenter(new FloatVec4(-2, -3.5f, -15))
                                .setRadius(1.5f)
                                .setIor(IoR.WATER)
//                        .setKd(new FloatVec4(0.05f, 0.f, 0.f))
                                .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
                                .setKr(new FloatVec4(0.1f, 0.1f, 0.1f))
                                .setPhongExp(1500)
                )
                .add("Teapot_Glass_Green", teapot()
                        .transform(new TranslateTransformation(0, -2, -25))
                        .setIor(IoR.WATER)
                        .setKd(new FloatVec4(0f, 0.05f, 0f))
                        .setKr(new FloatVec4(0.1f, 0.1f, 0.15f))
                )
                .add("Sphere_Red", new Sphere()
                        .setCenter(new FloatVec4(-7, -3.5f, -20))
                        .setRadius(1.5f)
                        .setKd(new FloatVec4(0.5f, 0.1f, 0.0f))
                        .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
                        .setKr(new FloatVec4(0.2f, 0.2f, 0.2f))
                        .setPhongExp(1500)
                )
                .add("Teapot_Tan", teapot()
                        .transform(new TranslateTransformation(-5, -2, -30))
                        .setIor(0)
                        .setKd(new FloatVec4(0.2f, 0.2f, 0.15f))
                        .setKr(new FloatVec4(0.2f, 0.2f, 0.1f))
                )
                .add("Sphere_Glass", new Sphere()
                                .setCenter(new FloatVec4(-12, -3.5f, -25))
                                .setRadius(1.5f)
                                .setIor(IoR.WATER)
//                        .setKd(new FloatVec4(0.5f, 0.1f, 0.0f))
                                .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
                                .setKr(new FloatVec4(0.1f, 0.1f, 0.1f))
                                .setPhongExp(1500)
                )
                .add("Box_Glass_1", glass()
                        .transform(new TranslateTransformation(-4, -5, -11))
                )
                .add("Box_Glass_1", glass()
                        .transform(new TranslateTransformation(1, -4.6, -4))
                )
                ;
    }

    private static TriangleMesh glass(){
        return (TriangleMesh) Meshes.cube()
                .transform(new CompositeTransformation()
                        .add(new ScaleTransformation(2.0f, 6.0f, 1f))
                        .add(RotateYTransformation.withGradAngle(-30))
                )
                .setIor(IoR.WINDOW_GLASS)
                .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
                .setKr(new FloatVec4(0.1f, 0.1f, 0.1f))
                .setPhongExp(1500);
    }

    private static TriangleMesh teapot() {
        return (TriangleMesh) Meshes.teapot()
                .transform(new CompositeTransformation()
                        .add(RotateXTransformation.withGradAngle(-90))
                        .add(RotateYTransformation.withGradAngle(180))
                        .add(RotateZTransformation.withGradAngle(30))
                        .add(RotateYTransformation.withGradAngle(35))
                        .add(new ScaleTransformation(0.38, 0.38, 0.38))
                )
                .setIor(IoR.WINDOW_GLASS)
                .setKs(new FloatVec4(0.5f, 0.5f, 0.5f))
//                .setKr(new FloatVec4(0.2f, 0.2f, 0.2f))
                .setPhongExp(1000);
    }
}
